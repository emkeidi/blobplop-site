import { j as createVNode, F as Fragment, k as spreadAttributes } from './astro.8a8e30e1.mjs';
import 'cookie';
import 'kleur/colors';
import '@astrojs/internal-helpers/path';
import 'path-to-regexp';
import 'mime';
import 'string-width';
import 'html-escaper';

const images = {
					
				};

				function updateImageReferences(html) {
					return html.replaceAll(
						/__ASTRO_IMAGE_="(.+)"/gm,
						(full, imagePath) => spreadAttributes({src: images[imagePath].src, ...images[imagePath].attributes})
					);
				}

				const html = updateImageReferences("<p>Recently I am on a mission to better understand my operating system. In my case that is Windows, which is also widely used at work. So, while I am curious to get deeper into MacOS, for now I will be focusing on PowerShell scripts and where better to learn the basics than with a ChatGPT session?</p>\n<h2 id=\"prompt-useful-powershell-scripts-every-developer-needs\">Prompt: \"useful PowerShell scripts every developer needs\"</h2>\n<p>Entering that as a message to ChatGPT yielded a veritable flood of ideas that some might refer to as an under-baked listicle. Lots of potential. What to learn first?</p>\n<p>Well, let's start with the ideas.</p>\n<p><em>ChatGPT Response:</em></p>\n<p>As a developer, PowerShell can be a powerful tool to automate tasks and streamline your workflow. Here are some useful PowerShell scripts that can help you in your development work:</p>\n<p><strong>1. File and Folder Operations:</strong></p>\n<ul>\n<li>Rename multiple files: Allows you to rename multiple files with a specified pattern or criteria.</li>\n<li>Create a folder structure: Creates a folder structure with multiple nested folders for organizing your projects.</li>\n<li>Delete files older than a certain date: Deletes files in a specified directory that are older than a specified date.</li>\n</ul>\n<p><strong>2. Git Operations:</strong></p>\n<ul>\n<li>Clone multiple Git repositories: Automates the process of cloning multiple Git repositories in one go.</li>\n<li>Pull changes for multiple repositories: Fetches and merges the latest changes from multiple Git repositories.</li>\n</ul>\n<p><strong>3. Build and Deployment:</strong></p>\n<ul>\n<li>Build and deploy projects: Automates the process of building and deploying your projects to different environments.</li>\n<li>Start/stop services: Starts or stops specified services on your local or remote machines.</li>\n</ul>\n<p><strong>4. Code Quality and Testing:</strong></p>\n<ul>\n<li>Static code analysis: Runs static code analysis tools (such as PSScriptAnalyzer) on your PowerShell scripts to identify potential issues and improve code quality.</li>\n<li>Run unit tests: Executes unit tests for your projects using PowerShell-based testing frameworks.</li>\n</ul>\n<p><strong>5. Server Management:</strong></p>\n<ul>\n<li>Check server availability: Pings a list of servers to check if they are online and accessible.</li>\n<li>Restart servers: Restarts specified servers remotely.</li>\n</ul>\n<p><strong>6. Data Operations:</strong></p>\n<ul>\n<li>CSV/Excel processing: Reads, manipulates, and writes data to CSV or Excel files.</li>\n<li>Database operations: Executes SQL queries against databases, performs backups/restores, or updates data.</li>\n</ul>\n<p><strong>7. System Monitoring and Reporting:</strong></p>\n<ul>\n<li>Performance monitoring: Collects and analyzes performance metrics of your system, such as CPU usage, memory consumption, and disk space.</li>\n<li>Generate reports: Generates reports in various formats (e.g., HTML, PDF) based on collected data or logs.</li>\n</ul>\n<blockquote>\n<p>Script Tip!\nRemember to always review and understand any script before running it, especially if it involves system-level operations or interacts with external resources. Adapt these scripts to fit your specific needs and requirements.</p>\n</blockquote>\n<h2 id=\"generate-a-system-monitoring-report\">Generate a System Monitoring Report</h2>\n<p>You can blame recency bias - the last one stood out to me so that's the first one we will explore.</p>\n<p>The first pass only includes CPU usage, which is nice to know, but a bit incomprehensive. I noticed in the initial response that memory and disk usage were also mentioned, so I asked for those to be added.</p>\n<pre is:raw=\"\" class=\"astro-code github-dark\" style=\"background-color: #24292e; overflow-x: auto;\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #E1E4E8\">$reportPath </span><span style=\"color: #F97583\">=</span><span style=\"color: #E1E4E8\"> </span><span style=\"color: #9ECBFF\">\"C:\\Reports\\System_Monitoring_Report.html\"</span></span>\n<span class=\"line\"><span style=\"color: #E1E4E8\">$cpuThreshold </span><span style=\"color: #F97583\">=</span><span style=\"color: #E1E4E8\"> </span><span style=\"color: #79B8FF\">80</span><span style=\"color: #E1E4E8\"> </span><span style=\"color: #6A737D\"># Set the threshold percentage for high CPU usage</span></span>\n<span class=\"line\"><span style=\"color: #E1E4E8\">$memoryThreshold </span><span style=\"color: #F97583\">=</span><span style=\"color: #E1E4E8\"> </span><span style=\"color: #79B8FF\">90</span><span style=\"color: #E1E4E8\"> </span><span style=\"color: #6A737D\"># Set the threshold percentage for high memory consumption</span></span>\n<span class=\"line\"><span style=\"color: #E1E4E8\">$diskThreshold </span><span style=\"color: #F97583\">=</span><span style=\"color: #E1E4E8\"> </span><span style=\"color: #79B8FF\">80</span><span style=\"color: #E1E4E8\"> </span><span style=\"color: #6A737D\"># Set the threshold percentage for high disk usage</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #6A737D\"># Get current CPU usage percentage</span></span>\n<span class=\"line\"><span style=\"color: #E1E4E8\">$cpuUsage </span><span style=\"color: #F97583\">=</span><span style=\"color: #E1E4E8\"> (</span><span style=\"color: #79B8FF\">Get-WmiObject</span><span style=\"color: #E1E4E8\"> </span><span style=\"color: #F97583\">-</span><span style=\"color: #E1E4E8\">Class Win32_Processor</span></span>\n<span class=\"line\"><span style=\"color: #F97583\">|</span><span style=\"color: #E1E4E8\"> </span><span style=\"color: #79B8FF\">Measure-Object</span><span style=\"color: #E1E4E8\"> </span><span style=\"color: #F97583\">-</span><span style=\"color: #E1E4E8\">Property LoadPercentage </span><span style=\"color: #F97583\">-</span><span style=\"color: #E1E4E8\">Average).Average</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #6A737D\"># Get current memory consumption percentage</span></span>\n<span class=\"line\"><span style=\"color: #E1E4E8\">$memoryUsage </span><span style=\"color: #F97583\">=</span><span style=\"color: #E1E4E8\"> </span><span style=\"color: #79B8FF\">Get-Counter</span><span style=\"color: #E1E4E8\"> </span><span style=\"color: #F97583\">-</span><span style=\"color: #E1E4E8\">Counter </span><span style=\"color: #9ECBFF\">\"\\Memory\\% Committed Bytes In Use\"</span></span>\n<span class=\"line\"><span style=\"color: #F97583\">|</span><span style=\"color: #E1E4E8\"> </span><span style=\"color: #79B8FF\">Select-Object</span><span style=\"color: #E1E4E8\"> </span><span style=\"color: #F97583\">-</span><span style=\"color: #E1E4E8\">ExpandProperty CounterSamples</span></span>\n<span class=\"line\"><span style=\"color: #F97583\">|</span><span style=\"color: #E1E4E8\"> </span><span style=\"color: #79B8FF\">Select-Object</span><span style=\"color: #E1E4E8\"> </span><span style=\"color: #F97583\">-</span><span style=\"color: #E1E4E8\">ExpandProperty CookedValue</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #6A737D\"># Get disk space usage percentage for the C drive</span></span>\n<span class=\"line\"><span style=\"color: #E1E4E8\">$diskUsage </span><span style=\"color: #F97583\">=</span><span style=\"color: #E1E4E8\"> (</span><span style=\"color: #79B8FF\">Get-WmiObject</span><span style=\"color: #E1E4E8\"> </span><span style=\"color: #F97583\">-</span><span style=\"color: #E1E4E8\">Class Win32_LogicalDisk </span><span style=\"color: #F97583\">-</span><span style=\"color: #E1E4E8\">Filter </span><span style=\"color: #9ECBFF\">\"DeviceID='C:'\"</span></span>\n<span class=\"line\"><span style=\"color: #F97583\">|</span><span style=\"color: #E1E4E8\"> </span><span style=\"color: #79B8FF\">Select-Object</span><span style=\"color: #E1E4E8\"> </span><span style=\"color: #F97583\">-</span><span style=\"color: #E1E4E8\">ExpandProperty FreeSpace)</span></span>\n<span class=\"line\"><span style=\"color: #F97583\">/</span><span style=\"color: #E1E4E8\"> (</span><span style=\"color: #79B8FF\">Get-WmiObject</span><span style=\"color: #E1E4E8\"> </span><span style=\"color: #F97583\">-</span><span style=\"color: #E1E4E8\">Class Win32_LogicalDisk </span><span style=\"color: #F97583\">-</span><span style=\"color: #E1E4E8\">Filter </span><span style=\"color: #9ECBFF\">\"DeviceID='C:'\"</span></span>\n<span class=\"line\"><span style=\"color: #F97583\">|</span><span style=\"color: #E1E4E8\"> </span><span style=\"color: #79B8FF\">Select-Object</span><span style=\"color: #E1E4E8\"> </span><span style=\"color: #F97583\">-</span><span style=\"color: #E1E4E8\">ExpandProperty Size) </span><span style=\"color: #F97583\">*</span><span style=\"color: #E1E4E8\"> </span><span style=\"color: #79B8FF\">100</span></span>\n<span class=\"line\"><span style=\"color: #E1E4E8\">$diskUsage </span><span style=\"color: #F97583\">=</span><span style=\"color: #E1E4E8\"> [</span><span style=\"color: #F97583\">Math</span><span style=\"color: #E1E4E8\">]::Round($diskUsage</span><span style=\"color: #F97583\">,</span><span style=\"color: #E1E4E8\"> </span><span style=\"color: #79B8FF\">2</span><span style=\"color: #E1E4E8\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #6A737D\"># Check if CPU, memory, or disk usage exceeds the thresholds</span></span>\n<span class=\"line\"><span style=\"color: #E1E4E8\">$highCpuUsage </span><span style=\"color: #F97583\">=</span><span style=\"color: #E1E4E8\"> $cpuUsage </span><span style=\"color: #F97583\">-gt</span><span style=\"color: #E1E4E8\"> $cpuThreshold</span></span>\n<span class=\"line\"><span style=\"color: #E1E4E8\">$highMemoryUsage </span><span style=\"color: #F97583\">=</span><span style=\"color: #E1E4E8\"> $memoryUsage </span><span style=\"color: #F97583\">-gt</span><span style=\"color: #E1E4E8\"> $memoryThreshold</span></span>\n<span class=\"line\"><span style=\"color: #E1E4E8\">$highDiskUsage </span><span style=\"color: #F97583\">=</span><span style=\"color: #E1E4E8\"> $diskUsage </span><span style=\"color: #F97583\">-gt</span><span style=\"color: #E1E4E8\"> $diskThreshold</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #6A737D\"># Generate the HTML report</span></span>\n<span class=\"line\"><span style=\"color: #E1E4E8\">$htmlReport </span><span style=\"color: #F97583\">=</span><span style=\"color: #E1E4E8\"> </span><span style=\"color: #9ECBFF\">@\"</span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">&#x3C;!DOCTYPE html></span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">&#x3C;html></span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">&#x3C;head></span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">    &#x3C;title>System Monitoring Report&#x3C;/title></span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">    &#x3C;style></span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">        body {</span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">            font-family: Arial, sans-serif;</span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">        }</span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">        .header {</span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">            background-color: #333;</span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">            color: #fff;</span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">            padding: 10px;</span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">        }</span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">        .content {</span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">            padding: 20px;</span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">        }</span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">        .high-usage {</span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">            color: red;</span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">            font-weight: bold;</span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">        }</span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">    &#x3C;/style></span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">&#x3C;/head></span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">&#x3C;body></span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">    &#x3C;div class=\"header\"></span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">        &#x3C;h1>System Monitoring Report&#x3C;/h1></span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">    &#x3C;/div></span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">    &#x3C;div class=\"content\"></span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">        &#x3C;h2>CPU Usage: &#x3C;span class=\"</span><span style=\"color: #F97583\">$</span><span style=\"color: #9ECBFF\">([</span><span style=\"color: #F97583\">bool</span><span style=\"color: #9ECBFF\">]</span><span style=\"color: #E1E4E8\">$highCpuUsage</span><span style=\"color: #9ECBFF\"> </span><span style=\"color: #F97583\">-as</span><span style=\"color: #9ECBFF\"> [</span><span style=\"color: #F97583\">int</span><span style=\"color: #9ECBFF\">])</span><span style=\"color: #9ECBFF\">\"></span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">        </span><span style=\"color: #F97583\">$</span><span style=\"color: #9ECBFF\">(</span><span style=\"color: #F97583\">if</span><span style=\"color: #9ECBFF\"> (</span><span style=\"color: #E1E4E8\">$highCpuUsage</span><span style=\"color: #9ECBFF\">) { </span><span style=\"color: #9ECBFF\">\"&#x3C;span class='high-usage'></span><span style=\"color: #E1E4E8\">$cpuUsage</span><span style=\"color: #9ECBFF\">%&#x3C;/span>\"</span><span style=\"color: #9ECBFF\"> }</span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">        </span><span style=\"color: #F97583\">else</span><span style=\"color: #9ECBFF\"> { </span><span style=\"color: #9ECBFF\">\"</span><span style=\"color: #E1E4E8\">$cpuUsage</span><span style=\"color: #9ECBFF\">%\"</span><span style=\"color: #9ECBFF\"> })</span><span style=\"color: #9ECBFF\">&#x3C;/span>&#x3C;/h2></span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">        &#x3C;h2>Memory Consumption: &#x3C;span class=\"</span><span style=\"color: #F97583\">$</span><span style=\"color: #9ECBFF\">([</span><span style=\"color: #F97583\">bool</span><span style=\"color: #9ECBFF\">]</span><span style=\"color: #E1E4E8\">$highMemoryUsage</span><span style=\"color: #9ECBFF\"> </span><span style=\"color: #F97583\">-as</span><span style=\"color: #9ECBFF\"> [</span><span style=\"color: #F97583\">int</span><span style=\"color: #9ECBFF\">])</span><span style=\"color: #9ECBFF\">\"></span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">        </span><span style=\"color: #F97583\">$</span><span style=\"color: #9ECBFF\">(</span><span style=\"color: #F97583\">if</span><span style=\"color: #9ECBFF\"> (</span><span style=\"color: #E1E4E8\">$highMemoryUsage</span><span style=\"color: #9ECBFF\">) { </span><span style=\"color: #9ECBFF\">\"&#x3C;span class='high-usage'></span><span style=\"color: #E1E4E8\">$memoryUsage</span><span style=\"color: #9ECBFF\">%&#x3C;/span>\"</span><span style=\"color: #9ECBFF\"> }</span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">        </span><span style=\"color: #F97583\">else</span><span style=\"color: #9ECBFF\"> { </span><span style=\"color: #9ECBFF\">\"</span><span style=\"color: #E1E4E8\">$memoryUsage</span><span style=\"color: #9ECBFF\">%\"</span><span style=\"color: #9ECBFF\"> })</span><span style=\"color: #9ECBFF\">&#x3C;/span>&#x3C;/h2></span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">        &#x3C;h2>Disk Space Usage (C:): &#x3C;span class=\"</span><span style=\"color: #F97583\">$</span><span style=\"color: #9ECBFF\">([</span><span style=\"color: #F97583\">bool</span><span style=\"color: #9ECBFF\">]</span><span style=\"color: #E1E4E8\">$highDiskUsage</span><span style=\"color: #9ECBFF\"> </span><span style=\"color: #F97583\">-as</span><span style=\"color: #9ECBFF\"> [</span><span style=\"color: #F97583\">int</span><span style=\"color: #9ECBFF\">])</span><span style=\"color: #9ECBFF\">\"></span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">        </span><span style=\"color: #F97583\">$</span><span style=\"color: #9ECBFF\">(</span><span style=\"color: #F97583\">if</span><span style=\"color: #9ECBFF\"> (</span><span style=\"color: #E1E4E8\">$highDiskUsage</span><span style=\"color: #9ECBFF\">) { </span><span style=\"color: #9ECBFF\">\"&#x3C;span class='high-usage'></span><span style=\"color: #E1E4E8\">$diskUsage</span><span style=\"color: #9ECBFF\">%&#x3C;/span>\"</span><span style=\"color: #9ECBFF\"> }</span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">        </span><span style=\"color: #F97583\">else</span><span style=\"color: #9ECBFF\"> { </span><span style=\"color: #9ECBFF\">\"</span><span style=\"color: #E1E4E8\">$diskUsage</span><span style=\"color: #9ECBFF\">%\"</span><span style=\"color: #9ECBFF\"> })</span><span style=\"color: #9ECBFF\">&#x3C;/span>&#x3C;/h2></span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">    &#x3C;/div></span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">&#x3C;/body></span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">&#x3C;/html></span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">\"@</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #6A737D\"># Save the report to a file</span></span>\n<span class=\"line\"><span style=\"color: #E1E4E8\">$htmlReport </span><span style=\"color: #F97583\">|</span><span style=\"color: #E1E4E8\"> </span><span style=\"color: #79B8FF\">Out-File</span><span style=\"color: #E1E4E8\"> </span><span style=\"color: #F97583\">-</span><span style=\"color: #E1E4E8\">FilePath $reportPath</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #6A737D\"># Open the report in the default web browser</span></span>\n<span class=\"line\"><span style=\"color: #79B8FF\">Start-Process</span><span style=\"color: #E1E4E8\"> $reportPath</span></span>\n<span class=\"line\"></span></code></pre>\n<h3 id=\"deep-dive-into-memory-usage\">Deep Dive Into Memory Usage</h3>\n<p>This short script is teaching me a lot. I follow how the variables are being assigned values in the first half of the script, and see them used in the HTML report which is then saved and opened in the default browser.</p>\n<p>I have not worked with many of the properties before, so I asked about the <code>$memoryUsage</code> line of code.</p>\n<p><em>ChatGPT Response:</em></p>\n<p>Certainly! Let's break down that line of code:</p>\n<p><code>Get-Counter -Counter \"\\Memory\\% Committed Bytes In Use\"</code> retrieves the performance counter for the percentage of committed bytes in use by the system's memory. The <code>\\Memory\\% Committed Bytes In Use</code> counter specifically measures the proportion of memory that has been allocated by processes but has not yet been written to disk.</p>\n<p><code>| Select-Object -ExpandProperty CounterSamples</code> takes the output of the <code>Get-Counter</code> cmdlet and selects the <code>CounterSamples</code> property. This property contains the actual performance counter data.</p>\n<p><code>| Select-Object -ExpandProperty CookedValue</code> selects the <code>CookedValue</code> property from the <code>CounterSamples</code> object. The <code>CookedValue</code> represents the calculated value of the performance counter, which in this case is the percentage of committed bytes in use.</p>\n<p>By assigning the result to the <code>$memoryUsage</code> variable, we retrieve the calculated value (in percentage) of the memory consumption and store it for further use in the script.</p>\n<hr>\n<p>OK, now I have some great jumping off points to continue learning later. I know what to look up in the PowerShell documentation to learn more about certain properties and cmdlets.</p>\n<h2 id=\"save-the-date\">Save The Date</h2>\n<p>The base version of the report is great. One issue is that each time the script is run, the file will be overwritten. To fix this, I adjust the script to construct a file path that includes the current time. This will generate unique files as long as they are created at least one second apart. That's close enough for me!</p>\n<pre is:raw=\"\" class=\"astro-code github-dark\" style=\"background-color: #24292e; overflow-x: auto;\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #E1E4E8\">$reportFolder </span><span style=\"color: #F97583\">=</span><span style=\"color: #E1E4E8\"> </span><span style=\"color: #9ECBFF\">\"C:\\Reports\"</span></span>\n<span class=\"line\"><span style=\"color: #E1E4E8\">$currentTime </span><span style=\"color: #F97583\">=</span><span style=\"color: #E1E4E8\"> </span><span style=\"color: #79B8FF\">Get-Date</span><span style=\"color: #E1E4E8\"> </span><span style=\"color: #F97583\">-</span><span style=\"color: #E1E4E8\">Format </span><span style=\"color: #9ECBFF\">\"yyyyMMdd_HHmmss\"</span></span>\n<span class=\"line\"><span style=\"color: #E1E4E8\">$reportPath </span><span style=\"color: #F97583\">=</span><span style=\"color: #E1E4E8\"> </span><span style=\"color: #79B8FF\">Join-Path</span><span style=\"color: #E1E4E8\"> </span><span style=\"color: #F97583\">-</span><span style=\"color: #E1E4E8\">Path $reportFolder </span><span style=\"color: #F97583\">-</span><span style=\"color: #E1E4E8\">ChildPath </span><span style=\"color: #9ECBFF\">\"System_Monitoring_Report_</span><span style=\"color: #E1E4E8\">$currentTime</span><span style=\"color: #9ECBFF\">.html\"</span></span></code></pre>\n<p>Running the script:</p>\n<p><img src=\"/run-pwsh-report.png\" alt=\"Run the System Report\"></p>\n<p>Result in default browser:</p>\n<p><img src=\"/system-monitoring-report-sample.png\" alt=\"Example Report\"></p>\n<p>Here is how the simple report should look in your default browser. Sure, it's barebones, but sometimes that is exactly what is called for.</p>\n<p>With the updates to the script to include the current date and time in the file path, this script serves as an efficient way to collect snapshots of system usage over time. More information could be added to the report, or you could always go look at Task Manager.</p>\n<p>This script is more of a learning tool to identify what to learn next.</p>\n<h2 id=\"convert-to-bash\">Convert To Bash</h2>\n<p>Seeing ChatGPT whip this script out in seconds flat has been entertaining to say the least. Since I have a MacBook Air for personal use, I wanted to play some more with this simple script.</p>\n<p>Let's see how converting to Bash goes:</p>\n<pre is:raw=\"\" class=\"astro-code github-dark\" style=\"background-color: #24292e; overflow-x: auto;\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #6A737D\">#!/bin/bash</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #E1E4E8\">report_folder</span><span style=\"color: #F97583\">=</span><span style=\"color: #9ECBFF\">\"/Users/your_username/Reports\"</span></span>\n<span class=\"line\"><span style=\"color: #E1E4E8\">current_time</span><span style=\"color: #F97583\">=</span><span style=\"color: #9ECBFF\">$(</span><span style=\"color: #B392F0\">date</span><span style=\"color: #9ECBFF\"> +\"%Y%m%d_%H%M%S\")</span></span>\n<span class=\"line\"><span style=\"color: #E1E4E8\">report_path</span><span style=\"color: #F97583\">=</span><span style=\"color: #9ECBFF\">\"</span><span style=\"color: #E1E4E8\">$report_folder</span><span style=\"color: #9ECBFF\">/System_Monitoring_Report_</span><span style=\"color: #E1E4E8\">$current_time</span><span style=\"color: #9ECBFF\">.html\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #E1E4E8\">cpu_threshold</span><span style=\"color: #F97583\">=</span><span style=\"color: #79B8FF\">80</span><span style=\"color: #E1E4E8\"> </span><span style=\"color: #6A737D\"># Set the threshold percentage for high CPU usage</span></span>\n<span class=\"line\"><span style=\"color: #E1E4E8\">memory_threshold</span><span style=\"color: #F97583\">=</span><span style=\"color: #79B8FF\">90</span><span style=\"color: #E1E4E8\"> </span><span style=\"color: #6A737D\"># Set the threshold percentage for high memory consumption</span></span>\n<span class=\"line\"><span style=\"color: #E1E4E8\">disk_threshold</span><span style=\"color: #F97583\">=</span><span style=\"color: #79B8FF\">80</span><span style=\"color: #E1E4E8\"> </span><span style=\"color: #6A737D\"># Set the threshold percentage for high disk usage</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #6A737D\"># Get current CPU usage percentage</span></span>\n<span class=\"line\"><span style=\"color: #E1E4E8\">cpu_usage</span><span style=\"color: #F97583\">=</span><span style=\"color: #9ECBFF\">$(</span><span style=\"color: #B392F0\">ps</span><span style=\"color: #9ECBFF\"> </span><span style=\"color: #79B8FF\">-A</span><span style=\"color: #9ECBFF\"> </span><span style=\"color: #79B8FF\">-o</span><span style=\"color: #9ECBFF\"> %cpu </span><span style=\"color: #F97583\">|</span><span style=\"color: #9ECBFF\"> </span><span style=\"color: #B392F0\">awk</span><span style=\"color: #9ECBFF\"> '{s+=$1} END {print s}')</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #6A737D\"># Get current memory consumption percentage</span></span>\n<span class=\"line\"><span style=\"color: #E1E4E8\">memory_usage</span><span style=\"color: #F97583\">=</span><span style=\"color: #9ECBFF\">$(</span><span style=\"color: #B392F0\">ps</span><span style=\"color: #9ECBFF\"> </span><span style=\"color: #79B8FF\">-A</span><span style=\"color: #9ECBFF\"> </span><span style=\"color: #79B8FF\">-o</span><span style=\"color: #9ECBFF\"> %mem </span><span style=\"color: #F97583\">|</span><span style=\"color: #9ECBFF\"> </span><span style=\"color: #B392F0\">awk</span><span style=\"color: #9ECBFF\"> '{s+=$1} END {print s}')</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #6A737D\"># Get disk space usage percentage for the root directory</span></span>\n<span class=\"line\"><span style=\"color: #E1E4E8\">disk_usage</span><span style=\"color: #F97583\">=</span><span style=\"color: #9ECBFF\">$(</span><span style=\"color: #B392F0\">df</span><span style=\"color: #9ECBFF\"> </span><span style=\"color: #79B8FF\">-h</span><span style=\"color: #9ECBFF\"> / </span><span style=\"color: #F97583\">|</span><span style=\"color: #9ECBFF\"> </span><span style=\"color: #B392F0\">tail</span><span style=\"color: #9ECBFF\"> </span><span style=\"color: #79B8FF\">-1</span><span style=\"color: #9ECBFF\"> </span><span style=\"color: #F97583\">|</span><span style=\"color: #9ECBFF\"> </span><span style=\"color: #B392F0\">awk</span><span style=\"color: #9ECBFF\"> '{print $5}' </span><span style=\"color: #F97583\">|</span><span style=\"color: #9ECBFF\"> </span><span style=\"color: #B392F0\">tr</span><span style=\"color: #9ECBFF\"> </span><span style=\"color: #79B8FF\">-d</span><span style=\"color: #9ECBFF\"> '%')</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #6A737D\"># Check if CPU, memory, or disk usage exceeds the thresholds</span></span>\n<span class=\"line\"><span style=\"color: #E1E4E8\">high_cpu_usage</span><span style=\"color: #F97583\">=</span><span style=\"color: #9ECBFF\">$(</span><span style=\"color: #B392F0\">awk</span><span style=\"color: #9ECBFF\"> </span><span style=\"color: #79B8FF\">-v</span><span style=\"color: #9ECBFF\"> cpu_usage=</span><span style=\"color: #E1E4E8\">$cpu_usage</span><span style=\"color: #9ECBFF\"> </span><span style=\"color: #79B8FF\">-v</span><span style=\"color: #9ECBFF\"> cpu_threshold=</span><span style=\"color: #E1E4E8\">$cpu_threshold</span><span style=\"color: #9ECBFF\"> 'BEGIN {print (cpu_usage > cpu_threshold)}')</span></span>\n<span class=\"line\"><span style=\"color: #E1E4E8\">high_memory_usage</span><span style=\"color: #F97583\">=</span><span style=\"color: #9ECBFF\">$(</span><span style=\"color: #B392F0\">awk</span><span style=\"color: #9ECBFF\"> </span><span style=\"color: #79B8FF\">-v</span><span style=\"color: #9ECBFF\"> memory_usage=</span><span style=\"color: #E1E4E8\">$memory_usage</span><span style=\"color: #9ECBFF\"> </span><span style=\"color: #79B8FF\">-v</span><span style=\"color: #9ECBFF\"> memory_threshold=</span><span style=\"color: #E1E4E8\">$memory_threshold</span><span style=\"color: #9ECBFF\"> 'BEGIN {print (memory_usage > memory_threshold)}')</span></span>\n<span class=\"line\"><span style=\"color: #E1E4E8\">high_disk_usage</span><span style=\"color: #F97583\">=</span><span style=\"color: #9ECBFF\">$(</span><span style=\"color: #B392F0\">awk</span><span style=\"color: #9ECBFF\"> </span><span style=\"color: #79B8FF\">-v</span><span style=\"color: #9ECBFF\"> disk_usage=</span><span style=\"color: #E1E4E8\">$disk_usage</span><span style=\"color: #9ECBFF\"> </span><span style=\"color: #79B8FF\">-v</span><span style=\"color: #9ECBFF\"> disk_threshold=</span><span style=\"color: #E1E4E8\">$disk_threshold</span><span style=\"color: #9ECBFF\"> 'BEGIN {print (disk_usage > disk_threshold)}')</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #6A737D\"># Generate the HTML report</span></span>\n<span class=\"line\"><span style=\"color: #E1E4E8\">html_report</span><span style=\"color: #F97583\">=</span><span style=\"color: #9ECBFF\">$(</span><span style=\"color: #B392F0\">cat</span><span style=\"color: #9ECBFF\"> </span><span style=\"color: #F97583\">&#x3C;&#x3C;</span><span style=\"color: #9ECBFF\">EOF</span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">&#x3C;!DOCTYPE html></span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">&#x3C;html></span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">&#x3C;head></span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">    &#x3C;title>System Monitoring Report&#x3C;/title></span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">    &#x3C;style></span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">        body {</span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">            font-family: Arial, sans-serif;</span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">        }</span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">        .header {</span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">            background-color: #333;</span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">            color: #fff;</span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">            padding: 10px;</span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">        }</span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">        .content {</span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">            padding: 20px;</span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">        }</span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">        .high-usage {</span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">            color: red;</span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">            font-weight: bold;</span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">        }</span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">    &#x3C;/style></span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">&#x3C;/head></span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">&#x3C;body></span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">    &#x3C;div class=\"header\"></span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">        &#x3C;h1>System Monitoring Report&#x3C;/h1></span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">    &#x3C;/div></span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">    &#x3C;div class=\"content\"></span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">        &#x3C;h2>CPU Usage: &#x3C;span class=\"</span><span style=\"color: #E1E4E8\">$high_cpu_usage</span><span style=\"color: #9ECBFF\">\">$(if [ \"</span><span style=\"color: #E1E4E8\">$high_cpu_usage</span><span style=\"color: #9ECBFF\">\" </span><span style=\"color: #F97583\">-eq</span><span style=\"color: #9ECBFF\"> </span><span style=\"color: #79B8FF\">1</span><span style=\"color: #9ECBFF\"> ]; </span><span style=\"color: #F97583\">then</span><span style=\"color: #9ECBFF\"> </span><span style=\"color: #79B8FF\">echo</span><span style=\"color: #9ECBFF\"> \"&#x3C;span class='high-usage'></span><span style=\"color: #E1E4E8\">$cpu_usage</span><span style=\"color: #9ECBFF\">%&#x3C;/span>\"; </span><span style=\"color: #F97583\">else</span><span style=\"color: #9ECBFF\"> </span><span style=\"color: #79B8FF\">echo</span><span style=\"color: #9ECBFF\"> \"</span><span style=\"color: #E1E4E8\">$cpu_usage</span><span style=\"color: #9ECBFF\">%\"; fi)&#x3C;/span>&#x3C;/h2></span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">        &#x3C;h2>Memory Consumption: &#x3C;span class=\"</span><span style=\"color: #E1E4E8\">$high_memory_usage</span><span style=\"color: #9ECBFF\">\">$(if [ \"</span><span style=\"color: #E1E4E8\">$high_memory_usage</span><span style=\"color: #9ECBFF\">\" </span><span style=\"color: #F97583\">-eq</span><span style=\"color: #9ECBFF\"> </span><span style=\"color: #79B8FF\">1</span><span style=\"color: #9ECBFF\"> ]; </span><span style=\"color: #F97583\">then</span><span style=\"color: #9ECBFF\"> </span><span style=\"color: #79B8FF\">echo</span><span style=\"color: #9ECBFF\"> \"&#x3C;span class='high-usage'></span><span style=\"color: #E1E4E8\">$memory_usage</span><span style=\"color: #9ECBFF\">%&#x3C;/span>\"; </span><span style=\"color: #F97583\">else</span><span style=\"color: #9ECBFF\"> </span><span style=\"color: #79B8FF\">echo</span><span style=\"color: #9ECBFF\"> \"</span><span style=\"color: #E1E4E8\">$memory_usage</span><span style=\"color: #9ECBFF\">%\"; fi)&#x3C;/span>&#x3C;/h2></span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">        &#x3C;h2>Disk Space Usage (root): &#x3C;span class=\"</span><span style=\"color: #E1E4E8\">$high_disk_usage</span><span style=\"color: #9ECBFF\">\">$(if [ \"</span><span style=\"color: #E1E4E8\">$high_disk_usage</span><span style=\"color: #9ECBFF\">\" </span><span style=\"color: #F97583\">-eq</span><span style=\"color: #9ECBFF\"> </span><span style=\"color: #79B8FF\">1</span><span style=\"color: #9ECBFF\"> ]; </span><span style=\"color: #F97583\">then</span><span style=\"color: #9ECBFF\"> </span><span style=\"color: #79B8FF\">echo</span><span style=\"color: #9ECBFF\"> \"&#x3C;span class='high-usage'></span><span style=\"color: #E1E4E8\">$disk_usage</span><span style=\"color: #9ECBFF\">%&#x3C;/span>\"; </span><span style=\"color: #F97583\">else</span><span style=\"color: #9ECBFF\"> </span><span style=\"color: #79B8FF\">echo</span><span style=\"color: #9ECBFF\"> \"</span><span style=\"color: #E1E4E8\">$disk_usage</span><span style=\"color: #9ECBFF\">%\"; fi)&#x3C;/span>&#x3C;/h2></span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">    &#x3C;/div></span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">&#x3C;/body></span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">&#x3C;/html></span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">EOF</span></span>\n<span class=\"line\"><span style=\"color: #9ECBFF\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #6A737D\"># Save the report to a file</span></span>\n<span class=\"line\"><span style=\"color: #79B8FF\">echo</span><span style=\"color: #E1E4E8\"> </span><span style=\"color: #9ECBFF\">\"</span><span style=\"color: #E1E4E8\">$html_report</span><span style=\"color: #9ECBFF\">\"</span><span style=\"color: #E1E4E8\"> </span><span style=\"color: #F97583\">></span><span style=\"color: #E1E4E8\"> </span><span style=\"color: #9ECBFF\">\"</span><span style=\"color: #E1E4E8\">$report_path</span><span style=\"color: #9ECBFF\">\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #6A737D\"># Open the report in the default web browser</span></span>\n<span class=\"line\"><span style=\"color: #B392F0\">open</span><span style=\"color: #E1E4E8\"> </span><span style=\"color: #9ECBFF\">\"</span><span style=\"color: #E1E4E8\">$report_path</span><span style=\"color: #9ECBFF\">\"</span></span>\n<span class=\"line\"></span></code></pre>\n<p>There was some explanation provided about the nature of the changes.</p>\n<p><em>ChatGPT Response:</em></p>\n<p>Please note the following adjustments made for macOS compatibility:</p>\n<ul>\n<li>The <code>report_folder</code> variable is updated with the desired folder path where reports should be saved.</li>\n<li>The <code>current_time</code> variable uses the <code>date</code> command with the appropriate format specifier.</li>\n<li>The <code>cpu_usage</code> value is obtained using <code>ps</code> command with the <code>-o %cpu</code> option.</li>\n<li>The <code>memory_usage</code> value is obtained using <code>ps</code> command with the <code>-o %mem</code> option.</li>\n<li>The <code>disk_usage</code> value is obtained using <code>df</code> command with the <code>/</code> directory and filtering for the root file system.</li>\n<li>The <code>high_cpu_usage</code>, <code>high_memory_usage</code>, and <code>high_disk_usage</code> variables are assigned using <code>awk</code> for comparison.</li>\n<li>The <code>html_report</code> variable uses a Bash \"here document\" (<code>&#x3C;&#x3C;EOF</code>) to store the HTML content.</li>\n<li>The report is opened using the <code>open</code> command, which opens the file in the default web browser.</li>\n</ul>\n<p>Remember to replace <code>\"your_username\"</code> in the <code>report_folder</code> variable with your actual macOS username. Additionally, ensure that the script is executable (<code>chmod +x script.sh</code>) before running it.</p>\n<p>The first pass was running fine once I entered my username. What did not look correct was seeing CPU usage over 200%. I asked if that value could be revised, but then it showed 0%. Then I looked up a command to see CPU usage on Mac and asked ChatGPT to use that.</p>\n<p>Similarly, for disk usage, that command was working fine, but it was pointing to the root instead of /System/Volumes/Data.</p>\n<p>Making both of these adjustments leaves me with values that make more sense. Memory usage looks high, however when checked against Activity Monitor the numbers seem accurate. I will have to learn about 'Memory Pressure' since that still looks low. I'd rather my system be using as much memory as possible to let the CPU breathe, and that seems to be happening.</p>\n<p>Here are the updated assignments:</p>\n<pre is:raw=\"\" class=\"astro-code github-dark\" style=\"background-color: #24292e; overflow-x: auto;\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #6A737D\"># --snip--</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #6A737D\"># CHANGED</span></span>\n<span class=\"line\"><span style=\"color: #6A737D\"># Get current CPU usage percentage</span></span>\n<span class=\"line\"><span style=\"color: #E1E4E8\">cpu_usage</span><span style=\"color: #F97583\">=</span><span style=\"color: #9ECBFF\">$(</span><span style=\"color: #B392F0\">top</span><span style=\"color: #9ECBFF\"> </span><span style=\"color: #79B8FF\">-l</span><span style=\"color: #9ECBFF\"> </span><span style=\"color: #79B8FF\">2</span><span style=\"color: #9ECBFF\"> </span><span style=\"color: #79B8FF\">-n</span><span style=\"color: #9ECBFF\"> </span><span style=\"color: #79B8FF\">0</span><span style=\"color: #9ECBFF\"> </span><span style=\"color: #F97583\">|</span><span style=\"color: #9ECBFF\"> </span><span style=\"color: #B392F0\">grep</span><span style=\"color: #9ECBFF\"> </span><span style=\"color: #79B8FF\">-E</span><span style=\"color: #9ECBFF\"> \"^CPU\" </span><span style=\"color: #F97583\">|</span><span style=\"color: #9ECBFF\"> </span><span style=\"color: #B392F0\">tail</span><span style=\"color: #9ECBFF\"> </span><span style=\"color: #79B8FF\">-1</span><span style=\"color: #9ECBFF\"> </span><span style=\"color: #F97583\">|</span><span style=\"color: #9ECBFF\"> </span><span style=\"color: #B392F0\">awk</span><span style=\"color: #9ECBFF\"> '{print $3}')</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #6A737D\"># --memory_usage is unchanged for now--</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #6A737D\"># CHANGED</span></span>\n<span class=\"line\"><span style=\"color: #6A737D\"># Get disk space usage percentage for the root directory</span></span>\n<span class=\"line\"><span style=\"color: #E1E4E8\">disk_usage</span><span style=\"color: #F97583\">=</span><span style=\"color: #9ECBFF\">$(</span><span style=\"color: #B392F0\">df</span><span style=\"color: #9ECBFF\"> </span><span style=\"color: #79B8FF\">-h</span><span style=\"color: #9ECBFF\"> /System/Volumes/Data </span><span style=\"color: #F97583\">|</span><span style=\"color: #9ECBFF\"> </span><span style=\"color: #B392F0\">tail</span><span style=\"color: #9ECBFF\"> </span><span style=\"color: #79B8FF\">-1</span><span style=\"color: #9ECBFF\"> </span><span style=\"color: #F97583\">|</span><span style=\"color: #9ECBFF\"> </span><span style=\"color: #B392F0\">awk</span><span style=\"color: #9ECBFF\"> '{print $5}' </span><span style=\"color: #F97583\">|</span><span style=\"color: #9ECBFF\"> </span><span style=\"color: #B392F0\">tr</span><span style=\"color: #9ECBFF\"> </span><span style=\"color: #79B8FF\">-d</span><span style=\"color: #9ECBFF\"> '%')</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #6A737D\"># --snip--</span></span></code></pre>\n<h2 id=\"shell-scripting-summation\">Shell Scripting Summation</h2>\n<p>Generating these scripts with the help of ChatGPT was a lot of fun. I'd like to think I learned a few things along the way. I still have tons to learn about operating systems and scripting languages.</p>\n<p>Before running these scripts I made sure to understand the gist of what was happening, stopping to look up new properties and methods I had not yet encountered. I enjoy this approach to learning at times more than attempting to read documentation from start to finish.</p>");

				const frontmatter = {"title":"Shell Scripting With ChatGPT","slug":"gpt-shell-scripting","draft":false,"description":"Learn how to use ChatGPT to quickly generate PowerShell and Bash scripts that will help every developer.","date":"2023-07-01T00:00:00.000Z","author":"Matthew Davis","category":"Learning"};
				const file = "E:/code/astro/curved-chaos/src/content/blobs/shell-scripting-with-chatgpt.md";
				const url = undefined;
				function rawContent() {
					return "\nRecently I am on a mission to better understand my operating system. In my case that is Windows, which is also widely used at work. So, while I am curious to get deeper into MacOS, for now I will be focusing on PowerShell scripts and where better to learn the basics than with a ChatGPT session?\n\n## Prompt: \"useful PowerShell scripts every developer needs\"\n\nEntering that as a message to ChatGPT yielded a veritable flood of ideas that some might refer to as an under-baked listicle. Lots of potential. What to learn first?\n\nWell, let's start with the ideas.\n\n_ChatGPT Response:_\n\nAs a developer, PowerShell can be a powerful tool to automate tasks and streamline your workflow. Here are some useful PowerShell scripts that can help you in your development work:\n\n**1. File and Folder Operations:**\n\n- Rename multiple files: Allows you to rename multiple files with a specified pattern or criteria.\n- Create a folder structure: Creates a folder structure with multiple nested folders for organizing your projects.\n- Delete files older than a certain date: Deletes files in a specified directory that are older than a specified date.\n\n**2. Git Operations:**\n\n- Clone multiple Git repositories: Automates the process of cloning multiple Git repositories in one go.\n- Pull changes for multiple repositories: Fetches and merges the latest changes from multiple Git repositories.\n\n**3. Build and Deployment:**\n\n- Build and deploy projects: Automates the process of building and deploying your projects to different environments.\n- Start/stop services: Starts or stops specified services on your local or remote machines.\n\n**4. Code Quality and Testing:**\n\n- Static code analysis: Runs static code analysis tools (such as PSScriptAnalyzer) on your PowerShell scripts to identify potential issues and improve code quality.\n- Run unit tests: Executes unit tests for your projects using PowerShell-based testing frameworks.\n\n**5. Server Management:**\n\n- Check server availability: Pings a list of servers to check if they are online and accessible.\n- Restart servers: Restarts specified servers remotely.\n\n**6. Data Operations:**\n\n- CSV/Excel processing: Reads, manipulates, and writes data to CSV or Excel files.\n- Database operations: Executes SQL queries against databases, performs backups/restores, or updates data.\n\n**7. System Monitoring and Reporting:**\n\n- Performance monitoring: Collects and analyzes performance metrics of your system, such as CPU usage, memory consumption, and disk space.\n- Generate reports: Generates reports in various formats (e.g., HTML, PDF) based on collected data or logs.\n\n> Script Tip!\n> Remember to always review and understand any script before running it, especially if it involves system-level operations or interacts with external resources. Adapt these scripts to fit your specific needs and requirements.\n\n## Generate a System Monitoring Report\n\nYou can blame recency bias - the last one stood out to me so that's the first one we will explore.\n\nThe first pass only includes CPU usage, which is nice to know, but a bit incomprehensive. I noticed in the initial response that memory and disk usage were also mentioned, so I asked for those to be added.\n\n```powershell\n$reportPath = \"C:\\Reports\\System_Monitoring_Report.html\"\n$cpuThreshold = 80 # Set the threshold percentage for high CPU usage\n$memoryThreshold = 90 # Set the threshold percentage for high memory consumption\n$diskThreshold = 80 # Set the threshold percentage for high disk usage\n\n# Get current CPU usage percentage\n$cpuUsage = (Get-WmiObject -Class Win32_Processor\n| Measure-Object -Property LoadPercentage -Average).Average\n\n# Get current memory consumption percentage\n$memoryUsage = Get-Counter -Counter \"\\Memory\\% Committed Bytes In Use\"\n| Select-Object -ExpandProperty CounterSamples\n| Select-Object -ExpandProperty CookedValue\n\n# Get disk space usage percentage for the C drive\n$diskUsage = (Get-WmiObject -Class Win32_LogicalDisk -Filter \"DeviceID='C:'\"\n| Select-Object -ExpandProperty FreeSpace)\n/ (Get-WmiObject -Class Win32_LogicalDisk -Filter \"DeviceID='C:'\"\n| Select-Object -ExpandProperty Size) * 100\n$diskUsage = [Math]::Round($diskUsage, 2)\n\n# Check if CPU, memory, or disk usage exceeds the thresholds\n$highCpuUsage = $cpuUsage -gt $cpuThreshold\n$highMemoryUsage = $memoryUsage -gt $memoryThreshold\n$highDiskUsage = $diskUsage -gt $diskThreshold\n\n# Generate the HTML report\n$htmlReport = @\"\n<!DOCTYPE html>\n<html>\n<head>\n    <title>System Monitoring Report</title>\n    <style>\n        body {\n            font-family: Arial, sans-serif;\n        }\n        .header {\n            background-color: #333;\n            color: #fff;\n            padding: 10px;\n        }\n        .content {\n            padding: 20px;\n        }\n        .high-usage {\n            color: red;\n            font-weight: bold;\n        }\n    </style>\n</head>\n<body>\n    <div class=\"header\">\n        <h1>System Monitoring Report</h1>\n    </div>\n    <div class=\"content\">\n        <h2>CPU Usage: <span class=\"$([bool]$highCpuUsage -as [int])\">\n        $(if ($highCpuUsage) { \"<span class='high-usage'>$cpuUsage%</span>\" }\n        else { \"$cpuUsage%\" })</span></h2>\n        <h2>Memory Consumption: <span class=\"$([bool]$highMemoryUsage -as [int])\">\n        $(if ($highMemoryUsage) { \"<span class='high-usage'>$memoryUsage%</span>\" }\n        else { \"$memoryUsage%\" })</span></h2>\n        <h2>Disk Space Usage (C:): <span class=\"$([bool]$highDiskUsage -as [int])\">\n        $(if ($highDiskUsage) { \"<span class='high-usage'>$diskUsage%</span>\" }\n        else { \"$diskUsage%\" })</span></h2>\n    </div>\n</body>\n</html>\n\"@\n\n# Save the report to a file\n$htmlReport | Out-File -FilePath $reportPath\n\n# Open the report in the default web browser\nStart-Process $reportPath\n\n```\n\n### Deep Dive Into Memory Usage\n\nThis short script is teaching me a lot. I follow how the variables are being assigned values in the first half of the script, and see them used in the HTML report which is then saved and opened in the default browser.\n\nI have not worked with many of the properties before, so I asked about the `$memoryUsage` line of code.\n\n_ChatGPT Response:_\n\nCertainly! Let's break down that line of code:\n\n`Get-Counter -Counter \"\\Memory\\% Committed Bytes In Use\"` retrieves the performance counter for the percentage of committed bytes in use by the system's memory. The `\\Memory\\% Committed Bytes In Use` counter specifically measures the proportion of memory that has been allocated by processes but has not yet been written to disk.\n\n`| Select-Object -ExpandProperty CounterSamples` takes the output of the `Get-Counter` cmdlet and selects the `CounterSamples` property. This property contains the actual performance counter data.\n\n`| Select-Object -ExpandProperty CookedValue` selects the `CookedValue` property from the `CounterSamples` object. The `CookedValue` represents the calculated value of the performance counter, which in this case is the percentage of committed bytes in use.\n\nBy assigning the result to the `$memoryUsage` variable, we retrieve the calculated value (in percentage) of the memory consumption and store it for further use in the script.\n\n---\n\nOK, now I have some great jumping off points to continue learning later. I know what to look up in the PowerShell documentation to learn more about certain properties and cmdlets.\n\n## Save The Date\n\nThe base version of the report is great. One issue is that each time the script is run, the file will be overwritten. To fix this, I adjust the script to construct a file path that includes the current time. This will generate unique files as long as they are created at least one second apart. That's close enough for me!\n\n```powershell\n$reportFolder = \"C:\\Reports\"\n$currentTime = Get-Date -Format \"yyyyMMdd_HHmmss\"\n$reportPath = Join-Path -Path $reportFolder -ChildPath \"System_Monitoring_Report_$currentTime.html\"\n```\n\nRunning the script:\n\n![Run the System Report](/run-pwsh-report.png)\n\nResult in default browser:\n\n![Example Report](/system-monitoring-report-sample.png)\n\nHere is how the simple report should look in your default browser. Sure, it's barebones, but sometimes that is exactly what is called for.\n\nWith the updates to the script to include the current date and time in the file path, this script serves as an efficient way to collect snapshots of system usage over time. More information could be added to the report, or you could always go look at Task Manager.\n\nThis script is more of a learning tool to identify what to learn next.\n\n## Convert To Bash\n\nSeeing ChatGPT whip this script out in seconds flat has been entertaining to say the least. Since I have a MacBook Air for personal use, I wanted to play some more with this simple script.\n\nLet's see how converting to Bash goes:\n\n```bash\n#!/bin/bash\n\nreport_folder=\"/Users/your_username/Reports\"\ncurrent_time=$(date +\"%Y%m%d_%H%M%S\")\nreport_path=\"$report_folder/System_Monitoring_Report_$current_time.html\"\n\ncpu_threshold=80 # Set the threshold percentage for high CPU usage\nmemory_threshold=90 # Set the threshold percentage for high memory consumption\ndisk_threshold=80 # Set the threshold percentage for high disk usage\n\n# Get current CPU usage percentage\ncpu_usage=$(ps -A -o %cpu | awk '{s+=$1} END {print s}')\n\n# Get current memory consumption percentage\nmemory_usage=$(ps -A -o %mem | awk '{s+=$1} END {print s}')\n\n# Get disk space usage percentage for the root directory\ndisk_usage=$(df -h / | tail -1 | awk '{print $5}' | tr -d '%')\n\n# Check if CPU, memory, or disk usage exceeds the thresholds\nhigh_cpu_usage=$(awk -v cpu_usage=$cpu_usage -v cpu_threshold=$cpu_threshold 'BEGIN {print (cpu_usage > cpu_threshold)}')\nhigh_memory_usage=$(awk -v memory_usage=$memory_usage -v memory_threshold=$memory_threshold 'BEGIN {print (memory_usage > memory_threshold)}')\nhigh_disk_usage=$(awk -v disk_usage=$disk_usage -v disk_threshold=$disk_threshold 'BEGIN {print (disk_usage > disk_threshold)}')\n\n# Generate the HTML report\nhtml_report=$(cat <<EOF\n<!DOCTYPE html>\n<html>\n<head>\n    <title>System Monitoring Report</title>\n    <style>\n        body {\n            font-family: Arial, sans-serif;\n        }\n        .header {\n            background-color: #333;\n            color: #fff;\n            padding: 10px;\n        }\n        .content {\n            padding: 20px;\n        }\n        .high-usage {\n            color: red;\n            font-weight: bold;\n        }\n    </style>\n</head>\n<body>\n    <div class=\"header\">\n        <h1>System Monitoring Report</h1>\n    </div>\n    <div class=\"content\">\n        <h2>CPU Usage: <span class=\"$high_cpu_usage\">$(if [ \"$high_cpu_usage\" -eq 1 ]; then echo \"<span class='high-usage'>$cpu_usage%</span>\"; else echo \"$cpu_usage%\"; fi)</span></h2>\n        <h2>Memory Consumption: <span class=\"$high_memory_usage\">$(if [ \"$high_memory_usage\" -eq 1 ]; then echo \"<span class='high-usage'>$memory_usage%</span>\"; else echo \"$memory_usage%\"; fi)</span></h2>\n        <h2>Disk Space Usage (root): <span class=\"$high_disk_usage\">$(if [ \"$high_disk_usage\" -eq 1 ]; then echo \"<span class='high-usage'>$disk_usage%</span>\"; else echo \"$disk_usage%\"; fi)</span></h2>\n    </div>\n</body>\n</html>\nEOF\n)\n\n# Save the report to a file\necho \"$html_report\" > \"$report_path\"\n\n# Open the report in the default web browser\nopen \"$report_path\"\n\n```\n\nThere was some explanation provided about the nature of the changes.\n\n_ChatGPT Response:_\n\nPlease note the following adjustments made for macOS compatibility:\n\n- The `report_folder` variable is updated with the desired folder path where reports should be saved.\n- The `current_time` variable uses the `date` command with the appropriate format specifier.\n- The `cpu_usage` value is obtained using `ps` command with the `-o %cpu` option.\n- The `memory_usage` value is obtained using `ps` command with the `-o %mem` option.\n- The `disk_usage` value is obtained using `df` command with the `/` directory and filtering for the root file system.\n- The `high_cpu_usage`, `high_memory_usage`, and `high_disk_usage` variables are assigned using `awk` for comparison.\n- The `html_report` variable uses a Bash \"here document\" (`<<EOF`) to store the HTML content.\n- The report is opened using the `open` command, which opens the file in the default web browser.\n\nRemember to replace `\"your_username\"` in the `report_folder` variable with your actual macOS username. Additionally, ensure that the script is executable (`chmod +x script.sh`) before running it.\n\nThe first pass was running fine once I entered my username. What did not look correct was seeing CPU usage over 200%. I asked if that value could be revised, but then it showed 0%. Then I looked up a command to see CPU usage on Mac and asked ChatGPT to use that.\n\nSimilarly, for disk usage, that command was working fine, but it was pointing to the root instead of /System/Volumes/Data.\n\nMaking both of these adjustments leaves me with values that make more sense. Memory usage looks high, however when checked against Activity Monitor the numbers seem accurate. I will have to learn about 'Memory Pressure' since that still looks low. I'd rather my system be using as much memory as possible to let the CPU breathe, and that seems to be happening.\n\nHere are the updated assignments:\n\n```bash\n# --snip--\n\n# CHANGED\n# Get current CPU usage percentage\ncpu_usage=$(top -l 2 -n 0 | grep -E \"^CPU\" | tail -1 | awk '{print $3}')\n\n# --memory_usage is unchanged for now--\n\n# CHANGED\n# Get disk space usage percentage for the root directory\ndisk_usage=$(df -h /System/Volumes/Data | tail -1 | awk '{print $5}' | tr -d '%')\n\n# --snip--\n```\n\n## Shell Scripting Summation\n\nGenerating these scripts with the help of ChatGPT was a lot of fun. I'd like to think I learned a few things along the way. I still have tons to learn about operating systems and scripting languages.\n\nBefore running these scripts I made sure to understand the gist of what was happening, stopping to look up new properties and methods I had not yet encountered. I enjoy this approach to learning at times more than attempting to read documentation from start to finish.\n";
				}
				function compiledContent() {
					return html;
				}
				function getHeadings() {
					return [{"depth":2,"slug":"prompt-useful-powershell-scripts-every-developer-needs","text":"Prompt: \"useful PowerShell scripts every developer needs\""},{"depth":2,"slug":"generate-a-system-monitoring-report","text":"Generate a System Monitoring Report"},{"depth":3,"slug":"deep-dive-into-memory-usage","text":"Deep Dive Into Memory Usage"},{"depth":2,"slug":"save-the-date","text":"Save The Date"},{"depth":2,"slug":"convert-to-bash","text":"Convert To Bash"},{"depth":2,"slug":"shell-scripting-summation","text":"Shell Scripting Summation"}];
				}
				async function Content() {
					const { layout, ...content } = frontmatter;
					content.file = file;
					content.url = url;
					const contentFragment = createVNode(Fragment, { 'set:html': html });
					return contentFragment;
				}
				Content[Symbol.for('astro.needsHeadRendering')] = true;

export { Content, compiledContent, Content as default, file, frontmatter, getHeadings, images, rawContent, url };
